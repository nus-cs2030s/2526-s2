
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://nus-cs2030s.github.io/2526-s2/36-monad.html">
      
      
        <link rel="prev" href="35-logger.html">
      
      
        <link rel="next" href="37-parallel.html">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>36. Monad - CS2030S Programming Methodology II</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700">
    
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&display=swap">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unit-36-monad" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="CS2030S Programming Methodology II" class="md-header__button md-logo" aria-label="CS2030S Programming Methodology II" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CS2030S Programming Methodology II
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              36. Monad
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="CS2030S Programming Methodology II" class="md-nav__button md-logo" aria-label="CS2030S Programming Methodology II" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    CS2030S Programming Methodology II
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Notes
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Notes
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="00-overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    0. Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Object-Orientation (1-22)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    Object-Orientation (1-22)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="01-compiler.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    1. Program and Compiler
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="02-type.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    2. Variables and Types
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="03-function.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    3. Functions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="04-encapsulation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    4. Encapsulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="05-infohiding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    5. Information Hiding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="06-tell-dont-ask.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    6. Tell, Don't Ask
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="07-static-field.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    7. Class Fields
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="08-static-method.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    8. Class Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="09-composition.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    9. Composition
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10-heap-stack.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    10. Heap and Stack
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="11-inheritance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    11. Inheritance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="12-overriding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    12. Overriding
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="13-overloading.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    13. Overloading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="14-polymorphism.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    14. Polymorphism
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="15-dynamic-binding.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    15. Method Invocation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="16-lsp.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    16. LSP
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="17-abstract.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    17. Abstract Class
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="18-interface.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    18. Interface
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="19-wrapper.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    19. Wrapper Class
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="20-casting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    20. Run-Time Class Mismatch
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="21-variance.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    21. Variance
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="22-exception.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    22. Exceptions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Types (23-27)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Types (23-27)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="23-generics.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    23. Generics
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="24-erasure.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    24. Type Erasure
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="25-unchecked.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    25. Unchecked Warnings
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="26-wildcard.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    26. Wildcards
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="27-inference.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    27. Type Inference
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_4" checked>
        
          
          <label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Functional (28-36)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Functional (28-36)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="28-immutability.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    28. Immutability
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="29-nested-classes.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    29. Nested Class
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="30-functions.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    30. Side Effect-Free Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="31-box-maybe.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    31. Box and Maybe
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="32-lazy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    32. Lazy Evaluation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="33-infinitelist.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    33. Infinite List
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="34-stream.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    34. Streams in Java
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="35-logger.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    35. Loggable
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    36. Monad
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="36-monad.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    36. Monad
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#generalizing-loggablet" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generalizing Loggable&lt;T&gt;
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identity-element-of-binary-operations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identity Element of Binary Operations
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algebraic-view-of-of-and-flatmap" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algebraic View of of and flatMap
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identity-laws" class="md-nav__link">
    <span class="md-ellipsis">
      
        Identity Laws
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maybe-is-partially-well-behaved" class="md-nav__link">
    <span class="md-ellipsis">
      
        Maybe is Partially Well-Behaved
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#associative-law" class="md-nav__link">
    <span class="md-ellipsis">
      
        Associative Law
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#a-counter-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Counter Example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functors" class="md-nav__link">
    <span class="md-ellipsis">
      
        Functors
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monads-and-functors-in-other-languages" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monads and Functors in Other Languages
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_5" >
        
          
          <label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Parallel/Asynchronous (37-39)
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Parallel/Asynchronous (37-39)
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="37-parallel.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    37. Parallel Streams
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="38-thread.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    38. Threads
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="39-async.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    39. Asynchronous Programming
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Programming Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Programming Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="environments.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Programming Environments
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="exercises.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Exercises
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="github.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Unix CLI
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Unix CLI
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="unix/background.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="unix/essentials.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Essentials
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="unix/advanced.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Advanced
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          <label class="md-nav__link" for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Vim
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    Vim
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vim/philosophy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Background
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vim/setup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Setup
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vim/quick-lessons.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Lessons
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vim/operations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tips
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vim/plugins.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Extensions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          <label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Micro
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    Micro
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="micro/operations.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Tips
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    Java Guide
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            
  
    Java Guide
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="style.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Coding Style
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="unit-36-monad">Unit 36: Monad</h1>
<div class="admonition abstract">
<p class="admonition-title">Learning Objectives</p>
<p>After this unit, students should be able to:</p>
<ul>
<li>recognize common structural patterns shared by <code>Maybe&lt;T&gt;</code>, <code>Lazy&lt;T&gt;</code>, <code>InfiniteList&lt;T&gt;</code>, and <code>Loggable&lt;T&gt;</code></li>
<li>explain the role of <code>of</code>, <code>map</code>, and <code>flatMap</code> in structuring computations with side information</li>
<li>state and apply the monad laws (left identity, right identity, associativity)</li>
<li>reason about why violating these laws leads to unintuitive or unsafe behavior</li>
<li>distinguish between functors and monads, and relate them to abstractions seen earlier in the course</li>
</ul>
</div>
<div class="admonition abstract">
<p class="admonition-title">Overview</p>
<p>In earlier units, we introduced abstractions such as <code>Maybe&lt;T&gt;</code>, <code>Lazy&lt;T&gt;</code>, and <code>InfiniteList&lt;T&gt;</code> to structure computations that may fail, be deferred, or be infinite. Although these classes appear different, they all support a similar style of programming: values are wrapped together with additional information, and computations are chained using methods like map and flatMap.</p>
<p>In this unit, we step back and study the common pattern behind these abstractions. We formalize what it means for such classes to be well behaved, introducing the notion of monads and the laws they must obey. Understanding these laws explains why our earlier designs work, why some seemingly small changes can break them, and how these ideas generalize beyond Java to other programming languages and paradigms.</p>
</div>
<h2 id="generalizing-loggablet">Generalizing <code>Loggable&lt;T&gt;</code></h2>
<p>We now have a class <code>Loggable&lt;T&gt;</code> with a <code>flatMap</code> method that allows us to operate on the value encapsulated inside, along with some "side information".  <code>Loggable&lt;T&gt;</code> follows a pattern that we have seen many times before.  We have seen this in <code>Maybe&lt;T&gt;</code> and <code>Lazy&lt;T&gt;</code>, and <code>InfiniteList&lt;T&gt;</code>.  Each of these classes has:</p>
<ul>
<li>an <code>of</code> method to initialize the value and side information.</li>
<li>a <code>flatMap</code> method to update the value and side information.</li>
</ul>
<p>Different classes above have different side information that is initialized, stored, and updated when we use the <code>of</code> and <code>flatMap</code> operations.  The class may also have other methods besides the two above.  Additionally, the methods may have different names.</p>
<table>
<thead>
<tr>
<th>Container</th>
<th>Side-Information</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Maybe&lt;T&gt;</code></td>
<td>The value might be there (i.e., <code>Some&lt;T&gt;</code>) or might not be there (i.e., <code>None</code>)</td>
</tr>
<tr>
<td><code>Lazy&lt;T&gt;</code></td>
<td>The value has been evaluated or not</td>
</tr>
<tr>
<td><code>Loggable&lt;T&gt;</code></td>
<td>The log describing the operations done on the value</td>
</tr>
</tbody>
</table>
<p>These classes follow certain patterns that make them well-behaved.  In particular, they behave predictably when created with <code>of</code> and chained with <code>flatMap</code>.  Such "well-behaved" classes are examples of a programming construct called <em>monads</em>.  </p>
<h2 id="identity-element-of-binary-operations">Identity Element of Binary Operations</h2>
<p>Before we examine what "well behaved" means, we first take a brief detour to look at algebraic structures in mathematics, particularly on the concept of <em>identity element</em> of a binary operation.</p>
<p>Let's consider the addition operation <span class="arithmatex">\(+\)</span> on integers.  We know that <span class="arithmatex">\(+\)</span> is a binary operation that takes in two integers and produces another integer.  For any integer <span class="arithmatex">\(x\)</span>, <span class="arithmatex">\(0 + x = x\)</span> and <span class="arithmatex">\(x + 0 = x\)</span>.  The integer <span class="arithmatex">\(0\)</span> is called the <em>identity element</em> of the binary operation <span class="arithmatex">\(+\)</span>, because adding <span class="arithmatex">\(0\)</span> to any integer <span class="arithmatex">\(x\)</span> does not change the value of <span class="arithmatex">\(x\)</span>.</p>
<p>Similarly, for the multiplication operation <span class="arithmatex">\(\times\)</span> on integers, we know that for any integer <span class="arithmatex">\(x\)</span>, <span class="arithmatex">\(1 \times x = x\)</span> and <span class="arithmatex">\(x \times 1 = x\)</span>.  The integer <span class="arithmatex">\(1\)</span> is the identity element of the binary operation <span class="arithmatex">\(\times\)</span>. </p>
<p>Now, consider the exponentiation operation on integers.  For any integer <span class="arithmatex">\(x\)</span>, we have <span class="arithmatex">\(x^1 = x\)</span>, but it is not true that <span class="arithmatex">\(1^x = x\)</span> (unless <span class="arithmatex">\(x\)</span> is 1).  So, 1 behaves like an identity element only when it is on the right side of the operation, but not on the left side.  In this case, we say that the 1 is the <em>right identity</em> of exponentiation, but not the <em>left identity</em>.  </p>
<p>On the other hand, 0 is both the left and right identity of <span class="arithmatex">\(+\)</span>; 1 is both the left and right identity of <span class="arithmatex">\(\times\)</span>.</p>
<h2 id="algebraic-view-of-of-and-flatmap">Algebraic View of <code>of</code> and <code>flatMap</code></h2>
<p>To help with the explanation below, we will now view a monad as a pair <span class="arithmatex">\((x, c)\)</span>, where <span class="arithmatex">\(x\)</span> is the value and <span class="arithmatex">\(c\)</span> is the side information.  </p>
<p>The argument to <code>flatMap</code> is a lambda that maps <span class="arithmatex">\(i\)</span> to <span class="arithmatex">\((f(i), c_f)\)</span>, where <span class="arithmatex">\(f(i)\)</span> is the new value and <span class="arithmatex">\(c_f\)</span> is the new side information produced by applying the lambda to <span class="arithmatex">\(i\)</span>.  The <code>flatMap</code> method applies the lambda to a target monad <span class="arithmatex">\((x, c)\)</span> to produce a new monad <span class="arithmatex">\((f(x), c \oplus c_f)\)</span>, where <span class="arithmatex">\(\oplus\)</span> is an operation that combines the side information.</p>
<p>Notationally, we write the <code>flatMap</code> operation as:</p>
<div class="arithmatex">\[(x, c) \text{ flatMap } \bigl(i \rightarrow (f(i), c_f)\bigr) = \bigl(f(x), c \oplus c_f\bigr)\]</div>
<p>As a concrete example, consider the <code>Maybe&lt;T&gt;</code> monad. Here, the side information is whether the value is present or not.  The operation <span class="arithmatex">\(\oplus\)</span> is defined such that if either side information indicates absence of value (<code>false</code>), the combined side information also indicates absence of value (<code>false</code>).  If both side information indicates the presence of value (<code>true</code>), the combined side information also indicates the presence of value (<code>true</code>).  In other words, <span class="arithmatex">\(\oplus\)</span> is the AND operation on binary values.</p>
<p>The <code>Loggable&lt;T&gt;</code> monad, on the other hand, has side information as a log string.  The operation <span class="arithmatex">\(\oplus\)</span> is string concatenation.</p>
<p>The <code>of</code> method of a monad takes a value and creates a new monad instance that encapsulates the value and initialize the side information.  We can view <code>of</code> as a function that maps from a value <span class="arithmatex">\(x\)</span> to a monad <span class="arithmatex">\((x, c_0)\)</span>, where <span class="arithmatex">\(c_0\)</span> is the initialized side information.</p>
<h2 id="identity-laws">Identity Laws</h2>
<p>For a monad to be well-behaved, it must obey certain laws.  The first two laws are about identity.  It says that the initialized side information <span class="arithmatex">\(c_0\)</span> must be both the left identity and the right identity of the corresponding <span class="arithmatex">\(\oplus\)</span> operation on the side information.</p>
<p>For instance, in our <code>Loggable&lt;T&gt;</code>,
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">of</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>The logger is initialized with empty side information (e.g., empty string as a log message).  The empty string is the identity of string concatenation, because for any string <code>s</code>, <code>"" + s = s</code> and <code>s + "" = s</code>.</p>
<p>Now, let's consider the lambda that we wish to pass into <code>flatMap</code>  &mdash; such a lambda takes in a value, computes it, and wraps it in a "new" monad, together with the corresponding side information.  For instance,</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">incrWithLog</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">incr</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;incr &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;; &quot;</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>What should we expect when we take a fresh new monad <code>Loggable.of(4)</code> and call <code>flatMap</code> with a function <code>incrWithLog</code>?  Since <code>Loggable.of(4)</code> is new with no operation performed on it yet, calling 
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">incrWithLog</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span>
</code></pre></div></td></tr></table></div></p>
<p>should result in the same value exactly as calling <code>incrWithLog(4)</code>.  So, we expect that, after calling the above, we have a <code>Loggable</code> with a value of 5 and a log message of <code>"incr 4"</code>.</p>
<p>Our <code>of</code> method should not do anything extra to the value and side information &mdash; it should simply wrap the value 4 into the <code>Loggable</code>.  Our <code>flatMap</code> method should not do anything extra to the value and the side information, it should simply apply the given lambda expression to the value.</p>
<p>Now, suppose we take an instance of <code>Loggable</code>, called <code>logger</code>, that has already been operated on one or more times with <code>flatMap</code>, and contains some side information.  What should we expect when we call:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">logger</span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></p>
<p>Since <code>of</code> should initialize the side information as the identity, it should not change the given side information.  The <code>flatMap</code> above should do nothing and the expression above should be the same as <code>logger</code>.</p>
<p>What we have described above is called the <em>left identity law</em> and the <em>right identity law</em> of monads.  Using the notations earlier, </p>
<p>The left identity law says:</p>
<div class="arithmatex">\[(x, c_0) \text{ flatMap } \bigl(i \rightarrow (f(i), c)\bigr) = (f(x), c)\]</div>
<p>The right identity law says:</p>
<div class="arithmatex">\[(x, c) \text{ flatMap } \bigl(i \rightarrow (i, c_0)\bigr) = (x, c)\]</div>
<p>The laws above hold because <span class="arithmatex">\(c_0 \oplus c = c\)</span> and <span class="arithmatex">\(c \oplus c_0 = c\)</span>.</p>
<p>To express this in Java, let <code>Monad</code> be a type that is a monad and <code>monad</code> be an instance of it.</p>
<p>The left identity law says:</p>
<ul>
<li><code>Monad.of(x).flatMap(i -&gt; f(i))</code> must be the same as <code>f(x)</code></li>
</ul>
<p>The right identity law says:</p>
<ul>
<li><code>monad.flatMap(i -&gt; Monad.of(i))</code> must be the same as <code>monad</code></li>
</ul>
<h2 id="maybe-is-partially-well-behaved">Maybe<T> is Partially Well-Behaved</h2>
<p>We have seen that <code>Loggable&lt;T&gt;</code> obey the identity laws, with <span class="arithmatex">\(\oplus\)</span> being the string concatenation and the identity <span class="arithmatex">\(c_0\)</span> being the empty string.  <code>Maybe&lt;T&gt;</code> also obeys the identity laws, with <span class="arithmatex">\(\oplus\)</span> being the AND operation on binary values and <span class="arithmatex">\(c_0\)</span> being <code>true</code> (indicating presence of value).</p>
<p>Now consider <code>Maybe&lt;T&gt;</code>.  We have seen that <span class="arithmatex">\(\oplus\)</span> is the AND operation on binary values.  The AND operation has <code>true</code> as its identity, but not <code>false</code>.  This means that <code>Maybe&lt;T&gt;</code> only obeys the identity laws only when the initialized side information is <code>true</code>, i.e., when we create a <code>Some&lt;T&gt;</code> instance.  If we create a <code>None</code> instance, the identity laws do not hold.  </p>
<p>For instance, <code>Maybe.none().flatMap(x -&gt; f(x))</code> equals to <code>Maybe.none()</code>, which is not always the same as <code>f(x)</code>.</p>
<p>In other words, <code>Maybe&lt;T&gt;</code> is a monad with respect to <code>Maybe::some</code> and <code>Maybe::flatMap</code> operations, but not with respect to <code>Maybe::none</code> and <code>Maybe::flatMap</code>.</p>
<h2 id="associative-law">Associative Law</h2>
<p>We now return to the original <code>incr</code> and <code>abs</code> functions.  To compose the functions, we can write <code>abs(incr(x))</code>, explicitly one function after another.  Or we can compose them as another function: 
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">int</span><span class="w"> </span><span class="nf">absIncr</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">abs</span><span class="p">(</span><span class="n">incr</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>and call it <code>absIncr(x)</code>.  The effects should be exactly the same.  It does not matter if we group the functions together into another function before applying it to a value x.</p>
<p>Recall that after we built our <code>Loggable</code> class, we were able to compose the functions <code>incr</code> and <code>abs</code> by chaining the <code>flatMap</code>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">incrWithLog</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">absWithLog</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<p>We should get the resulting value as <code>abs(incr(4))</code>, along with the appropriate log messages.</p>
<p>Another way to call <code>incr</code> and then <code>abs</code> is to write something like this:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">absIncrWithLog</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">incrWithLog</span><span class="p">(</span><span class="n">x</span><span class="p">).</span><span class="na">flatMap</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">absWithLog</span><span class="p">(</span><span class="n">y</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>We have composed the methods <code>incrWithLog</code> and <code>absWithLog</code> and grouped them under another method.  Now, if we call:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">absIncrWithLog</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></p>
<p>The two expressions above must have exactly the same effect on the value and its log message.</p>
<p>This example leads us to the third law of monads: regardless of how we group those calls to <code>flatMap</code>, their behavior must be the same.  This law is called the <em>associative law</em>.  Using our notations earlier, the law says:</p>
<div class="arithmatex">\[\begin{aligned}
\bigl((x, c) \text{ flatMap } (i \rightarrow (f(i), c_f))\bigr) \text{ flatMap } (j \rightarrow (g(j), c_g) =\\ 
(x, c) \text{ flatMap } (i \rightarrow \bigl((f(i), c_f) \text{ flatMap } (j \rightarrow (g(j), c_g)\bigr))
\end{aligned}
\]</div>
<p>If we unpack the notations above, we have the left hand side as:</p>
<div class="arithmatex">\[
\begin{aligned}
\bigl((x, c) \;\text{flatMap}\; (i \to (f(i), c_f))\bigr) \;\text{flatMap}\; (j \to (g(j), c_g)) &amp;= {}\\
(f(x), c \oplus c_f) \;\text{flatMap}\; (j \to (g(j), c_g)) &amp;= {}\\
(g(f(x)), (c \oplus c_f) \oplus c_g) 
\end{aligned}
\]</div>
<p>and the right hand side as:</p>
<div class="arithmatex">\[
\begin{aligned}
(x, c) \;\text{flatMap}\;
  \bigl(i \to ((f(i), c_f) \;\text{flatMap}\; (j \to (g(j), c_g)))\bigr) &amp;= \\
  (x, c) \;\text{flatMap}\; \bigl(i \to (g(f(i)), c_f \oplus c_g)\bigr) &amp;= \\
  (g(f(x)), c \oplus (c_f \oplus c_g))
\end{aligned}
\]</div>
<p>For both sides to be equivalent, the <span class="arithmatex">\(\oplus\)</span> operation on the side information must be associative, i.e., </p>
<div class="arithmatex">\[(c_1 \oplus c_2) \oplus c_3 = c_1 \oplus (c_2 \oplus c_3)\]</div>
<p>Expressing it in Java, the law is:</p>
<ul>
<li><code>monad.flatMap(x -&gt; f(x)).flatMap(x -&gt; g(x))</code> must be the same as <code>monad.flatMap(x -&gt; f(x).flatMap(y -&gt; g(y)))</code></li>
</ul>
<p>In our examples, <code>Loggable&lt;T&gt;</code> is well-behaved, since string concatenation is associative.  <code>Maybe&lt;T&gt;</code> is also well-behaved, since the AND operation on binary values is associative.</p>
<h2 id="a-counter-example">A Counter Example</h2>
<p>Let's see why following the laws are important.</p>
<p>If our monads follow the laws above, we can safely write methods that receive a monad from others, operate on it, and return it to others.  We can also safely create a monad and pass it to the clients to operate on.  Our clients can then call our methods in any order and operate on the monads that we create, and the effect on its value and side information is as expected.</p>
<p>Let's try to make our <code>Loggable</code> misbehave a little.  Suppose we change our <code>Loggable&lt;T&gt;</code> to be as follows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// version 0.3 (NOT a monad)</span>
<span class="kd">class</span> <span class="nc">Loggable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">log</span><span class="p">;</span>

<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="nf">Loggable</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">log</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">value</span><span class="p">;</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">of</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;&gt;</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Logging starts: &quot;</span><span class="p">);</span>
</span><span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">flatMap</span><span class="p">(</span><span class="n">Transformer</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">super</span><span class="w"> </span><span class="n">T</span><span class="p">,</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Loggable</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">R</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">transformer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Loggable</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">R</span><span class="o">&gt;</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">transformer</span><span class="p">.</span><span class="na">transform</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">value</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Loggable</span><span class="p">(</span><span class="n">logger</span><span class="p">.</span><span class="na">value</span><span class="p">,</span><span class="w"> </span><span class="n">logger</span><span class="p">.</span><span class="na">log</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="p">);</span>
</span><span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">toString</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;value: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">value</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, log: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">log</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Our <code>of</code> adds a little initialization message.  Our <code>flatMap</code> adds a little new line before appending with the given log message.  Now, our <code>Loggable&lt;T&gt;</code> is not that well-behaved anymore.</p>
<p>Suppose we have two methods <code>foo</code> and <code>bar</code>, both take in an <code>x</code> and perform a series of operations on <code>x</code>.  Both return us a <code>Loggable</code> instance on the final value and its log.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Loggable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">                 </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(...)</span>
<span class="w">                 </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(...)</span>
<span class="w">                   </span><span class="p">:</span>
<span class="w">  </span><span class="p">;</span>
<span class="p">}</span>
<span class="n">Loggable</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">bar</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">Loggable</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">                 </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(...)</span>
<span class="w">                 </span><span class="p">.</span><span class="na">flatMap</span><span class="p">(...)</span>
<span class="w">                   </span><span class="p">:</span>
<span class="w">  </span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Now, we want to perform the sequence of operations done in <code>foo</code>, followed by the sequence of operations done in <code>bar</code>.  So we called:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">foo</span><span class="p">(</span><span class="mi">4</span><span class="p">).</span><span class="na">flatMap</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></td></tr></table></div></p>
<p>We will find that the string <code>"Logging starts"</code> appears twice in our logs and there is now an extra blank line in the log file!</p>
<h2 id="functors">Functors</h2>
<p>We will end this unit with a brief discussion on <em>functors</em>, another common abstraction in functional-style programming.  A functor is a simpler construction than a monad in that it only ensures lambdas can be applied sequentially to the value, without worrying about side information.</p>
<p>Recall that when we build our <code>Loggable&lt;T&gt;</code> abstraction, we add a <code>map</code> that only updates the value but changes nothing to the side information, i.e.,</p>
<div class="arithmatex">\[(x, c) map (i \rightarrow f(i)) = (f(i), c)\]</div>
<p>One can think of a functor as an abstraction that supports <code>map</code>.</p>
<p>A functor needs to adhere to two laws:</p>
<ul>
<li>preserving identity: <code>functor.map(x -&gt; x)</code> is the same as <code>functor</code></li>
<li>preserving composition: <code>functor.map(x -&gt; f(x)).map(x -&gt; g(x))</code> is the same as <code>functor.map(x -&gt; g(f(x))</code>. </li>
</ul>
<p>Our classes from <code>cs2030s.fp</code>, <code>Lazy&lt;T&gt;</code>, <code>Maybe&lt;T&gt;</code>, and <code>InfiniteList&lt;T&gt;</code> are functors as well.</p>
<h2 id="monads-and-functors-in-other-languages">Monads and Functors in Other Languages</h2>
<p>Although we have explored monads through Java, monads are a language-independent abstraction for structuring computations that carry additional context or effects.</p>
<p>In purely functional languages such as Haskell, monads play a central role. Because functions in Haskell are not allowed to produce side effects directly, monads provide a disciplined way to model effects such as failures, state, and input/output.  In other languages such as Scala, monads appear in everyday programming.  Collections, futures, and other abstractions support operations analogous to <code>map</code> and <code>flatMap</code>, allowing programmers to write chained computations in a clear, imperative-looking style, while still relying on the same monadic laws underneath.</p>
<p>From a broader perspective, monads represent a shift in how we think about program design. Instead of scattering special cases, flags, or global state throughout our code, we localize complexity inside a well-defined abstraction. The monad laws then act as a contract, ensuring that code remains composable and refactorable.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright by Department of Computer Science, National University of Singapore 2026
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["toc.follow", "toc.integrate", "content.code.annotate", "content.code.copy"], "search": "assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="javascripts/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>